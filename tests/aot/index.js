var e=(e,t,n)=>[e,t,,n];let t=e=>[0,e];let n=(e,t)=>[1,t,e];let r=(e,t)=>[3,t,e];let i={type:null};let a=(e,t,n,...r)=>[e,t,n,r.length===0?i:Object.assign({type:null},...r)];let o=(...e)=>a(``,...e);let s=(...e)=>a(`POST`,...e);var c=e([t(e=>{console.log(e.req)}),n(`id`,()=>performance.now())],[o(`/path`,e=>e.id)],{"/api":e([r(`body`,async e=>e.req.text())],[s(`/body`,e=>e.body)])});let l=(e,t)=>{let n=e+t;return/.\/$/.test(n)?e:n};let u=(async()=>{}).constructor;let d=[,,,,,];let f=e=>e[3]??=d[4](e[2][0],e[2][1],e);let p=e=>{e[2]!=null&&(e[3]=null)};let m=e=>{if(e[1])return``;e[1]=true;p(e);return d[2]};let h=e=>{if(e[0])return``;e[0]=true;p(e);return`return (async()=>{`};let g=e=>{if(e[4])return`t`;e[4]=true;return`let t`};let _=(e,t,n)=>{if(e[2]!=null){t[2]=e[2];t[3]=null}for(let n=0,r=e[0];n<r.length;n++){let e=r[n];let i=e[1];let a=e[0];if(a===-1)i(t);else{d[1].push(i);if(i.length>0)m(t);if(i instanceof u)h(t);if(a===1)m(t);else if(a===2){g(t);f(t)}else if(a===3){g(t);f(t);m(t)}}}for(let r=0,i=e[1];r<i.length;r++){let e=i[r];let a=l(n,e[1]);d[3](e[2],e[3],a,t)}let r=e[3];if(r!=null)for(let e in r)_(r[e],t.slice(),e===`/`?n:n+e)};let v=Symbol.for(`@safe-std/error`);let y=e=>Array.isArray(e)&&e[0]===v;var b=e=>({status:200,req:e,headers:[]});let x=e=>{d[1].push(e);return``};let S=e=>{``+d[1].push(e);return``};var C=e=>{d[0]={};d[1]=[];d[2]=`let c=mwc(r);`;d[3]=x;d[4]=S;_(e,[false,false,,`return mwb`,false],``);return[y,b].concat(d[1])};var w={fetch:((e,t,n,r,i,a,o)=>{var s=[`text/html`,`application/json`].map(e=>[`Content-Type`,e]),[c,l]=s,[u,d]=s.map(e=>({headers:[e]})),[f,p]=[404,400].map(e=>new Response(null,{status:e}));return s=>{let c=s.url,l=c.indexOf(`/`,12)+1,u=c.indexOf(`?`,l),d=u===-1?c.slice(l):c.slice(l,u);if(s.method===`POST`){if(d===`api/body`){let i=t(s);n(i);i.id=r();return(async()=>{let t=await a(i);if(e(t))return p;i.body=t;return new Response(o(i),i)})()}}if(d===`path`){let e=t(s);n(e);e.id=r();return new Response(i(e),e)}return f}})(...C(c))};export{w as default};