var core_default=(middlewares,handlers,children)=>[middlewares,handlers,,children];let tap=f=>[0,f],attach=(prop,f)=>[1,f,prop],noType={type:null},route=(method,path,handler,...dat)=>[method,path,handler,dat.length===0?noType:Object.assign({type:null},...dat)],any=(...a)=>route(``,...a),post=(...a)=>route(`POST`,...a);var main_default=core_default([tap(c=>{console.log(c.req)}),attach(`id`,()=>performance.now())],[any(`/path`,c=>c.id)],{"/api":core_default([attach(`body`,async c=>c.req.text())],[post(`/body`,c=>c.body)])});let AsyncFunction=(async()=>{}).constructor,compilerState=[,,,,,],compileErrorHandler$1=scope=>scope[3]??=compilerState[4](scope[2][0],scope[2][1],scope),clearErrorHandler=scope=>{scope[2]!=null&&(scope[3]=null)},createContext=scope=>scope[1]?``:(scope[1]=!0,clearErrorHandler(scope),compilerState[2]),createAsyncScope=scope=>scope[0]?``:(scope[0]=!0,clearErrorHandler(scope),`return (async()=>{`),setTmp=scope=>scope[4]?`t`:(scope[4]=!0,`let t`),hydrateDependency$1=(group,scope,prefix)=>{group[2]!=null&&(scope[2]=group[2],scope[3]=null);for(let i=0,middlewares=group[0];i<middlewares.length;i++){let middleware=middlewares[i],fn=middleware[1],id=middleware[0];id===-1?fn(scope):(compilerState[1].push(fn),fn.length>0&&createContext(scope),fn instanceof AsyncFunction&&createAsyncScope(scope),id===1?createContext(scope):id===2?(setTmp(scope),compileErrorHandler$1(scope)):id===3&&(setTmp(scope),compileErrorHandler$1(scope),createContext(scope)))}for(let i=0,handlers=group[1];i<handlers.length;i++){let handler=handlers[i];compilerState[3](handler[2],handler[3],prefix+(handler[1]===`/`||prefix!==``?``:handler[1]),scope)}let childGroups=group[3];if(childGroups!=null)for(let childPrefix in childGroups)hydrateDependency$1(childGroups[childPrefix],scope.slice(),childPrefix===`/`?prefix:prefix+childPrefix)},_=Symbol.for(`@safe-std/error`),isErr=u=>Array.isArray(u)&&u[0]===_;var context_default=r=>({status:200,req:r,headers:[]});let compileHandler=fn=>(compilerState[1].push(fn),``),compileErrorHandler=fn=>(``+compilerState[1].push(fn),``);var aot_default$1=router=>(compilerState[0]={},compilerState[1]=[],compilerState[2]=`let c=mwc(r);`,compilerState[3]=compileHandler,compilerState[4]=compileErrorHandler,hydrateDependency$1(router,[!1,!1,,`return mwb`,!1],``),[isErr,context_default].concat(compilerState[1]));if(!(()=>!0)())throw Error(`Invalid state!`);var aot_default={fetch:((me,mwc,f1,f2,f3,f4,f5)=>{var t=[`text/html`,`application/json`].map(c=>[`Content-Type`,c]),[mwh,mwj]=t,[mwoh,mwoj]=t.map(c=>({headers:[c]})),[mwn,mwb]=[404,400].map(s=>new Response(null,{status:s}));return r=>{let u=r.url,s=u.indexOf(`/`,12)+1,e=u.indexOf(`?`,s),p=e===-1?u.slice(s):u.slice(s,e);if(r.method===`POST`&&p===`api`){let c=mwc(r);return f1(c),c.id=f2(),(async()=>(c.body=await f4(c),new Response(f5(c),c)))()}if(p===`path`){let c=mwc(r);return f1(c),c.id=f2(),new Response(f3(c),c)}return mwn}})(...aot_default$1(main_default))};export{aot_default as default};